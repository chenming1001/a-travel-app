# 智能旅行助手 (Smart Travel Assistant)
> **途个开心** —— 基于大语言模型与数据可视化的全栈智能旅行规划平台。
## 项目简介
**途个开心** 是一款集成了生成式 AI（LLM）的现代化旅行助手。旨在解决传统旅行规划中“信息分散”、“决策困难”和“缺乏数据复盘”的痛点。
本项目采用 **React + FastAPI** 前后端分离架构，不仅能通过自然语言对话生成详细行程，更具备强大的**数据科学分析能力**，能够对用户的旅行历史进行多维度的“心理学诊断”和可视化展示。
## 核心功能
### 1\. AI 智能对话与规划
  - 集成 **阿里通义千问 (Qwen)** 大模型。
  - 支持流式对话，通过自然语言（如“帮我规划一个成都三日美食游”）一键生成结构化行程。
  - 自动提取行程中的地点、预算、标签等关键信息并存入数据库。
### 2\. 交互式旅行看板 (Dashboard)
  - **核心指标**：实时展示总旅行次数、累计花费、足迹覆盖里程等。
  - **动态天气**：接入 **高德地图 API**，智能显示即将出行目的地的实时天气与预报。
### 3\. AI 深度行为诊断 (Data Science)
  - **五维人格雷达图**：基于算法计算用户的探索度、奢华度、社交度、行动力、紧凑度。
  - **自定义 SVG 图表**：手写无依赖的月度出行热力图、消费阶梯分布柱状图。
  - **智能分析报告**：AI 读取全量历史数据，生成专业的消费陷阱分析与行为模式诊断。
  - **硬核指标**：计算“人均单日投入 (CPPPD)”、“决策提前期”等深度经济学指标。
### 4\.  智能行程管理
  - 支持旅行记录的增删改查 (CRUD)。
  - **智能填单**：支持图片预览上传、标签自动去重与回车快捷添加。
  - **数据同步**：优化的前端刷新机制，确保积分、统计数据与后端实时强一致。
##  技术栈
### 前端 (Frontend)
  - **框架**: React 18 (Vite)
  - **样式**: Tailwind CSS (自定义 Dark Mode 策略)
  - **图标**: Lucide React
  - **网络请求**: Axios
  - **可视化**: 自定义 SVG 组件 (摆脱庞大的图表库依赖)
### 后端 (Backend)
  - **框架**: FastAPI
  - **语言**: Python 3.9+
  - **数据库**: SQLite + SQLAlchemy (使用复杂的聚合查询 `func.count`, `case`)
  - **AI 接口**: DashScope SDK (通义千问)
  - **地图服务**: Amap API (高德地图 Web 服务)
##  快速开始
### 环境要求
  - Node.js \> 16
  - Python \> 3.9
### 1\. 后端设置
```bash
cd backend
# 启动服务
python main.py
# 服务将运行在 http://127.0.0.1:8000
```
### 2\. 前端设置
```bash
cd frontend
# 安装依赖
npm install
# 启动开发服务器
npm run dev
# 访问 http://localhost:5173
```
## 项目结构
```
WanderAI/
├── backend/
│   ├── main.py             # FastAPI 主入口 (含核心逻辑、AI接口、数据分析算法)
│   ├── database.py         # 数据库连接与模型定义
│   ├── auth.py             # JWT 认证逻辑
│   ├── llm_engine.py       # 大模型调用封装
│   └── wanderai.db         # SQLite 数据库文件
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   │   ├── AddTripModal.jsx        # 添加/编辑旅行 (含逻辑修复)
│   │   │   ├── InteractiveDashboard.jsx# 主看板 (含天气、推荐)
│   │   │   ├── DataAnalysisModal.jsx   # AI深度分析弹窗 (含雷达图)
│   │   │   └── ...
│   │   ├── contexts/       # AuthContext
│   │   └── App.jsx         # 路由与主题配置
│   └── public/             # 静态资源 (logo.png)
└── README.md
```
##  常见问题与修复记录

1.  **500 Internal Server Error (Datetime 类型错误)**
      * *原因*：Python 中 `datetime` 与 `date` 对象无法直接相减。
      * *解决*：后端已统一时间类型转换逻辑。
2.  **图表显示为空**
      * *解决*：前端已增加兜底数据策略，当用户未填写日期时，自动生成占位数据，避免图表塌陷。
3.  **Logo 白底违和**
      * *解决*：已使用去背工具处理 Logo 为透明 PNG，并调整了阴影色调以匹配 UI 主题。
